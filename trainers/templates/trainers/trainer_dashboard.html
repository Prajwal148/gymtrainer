{% extends 'base.html' %}

{% block content %}
    <div class="container mt-5">
        <h1 class="text-center">Trainer Dashboard</h1>

        <!-- Dropdown to select a user -->
        <form method="POST" class="mb-4">
            {% csrf_token %}
            <select name="user_id" class="form-control" onchange="this.form.submit()">
                <option value="">Select a User</option>
                {% for user in users %}
                    <option value="{{ user.id }}" {% if selected_user == user %}selected{% endif %}>
                        {{ user.user.first_name }} {{ user.user.last_name }}
                    </option>
                {% endfor %}
            </select>
        </form>

        {% if selected_user %}
            <!-- Display user profile and allow diet/workout plan editing -->
            <div class="card shadow-lg p-4 mb-4">
                <h2 class="text-center">{{ selected_user.user.first_name }} {{ selected_user.user.last_name }}</h2>
                <p><strong>Age:</strong> {{ selected_user.calculate_age }} years</p>
                <p><strong>BMI:</strong> {{ selected_user.calculate_bmi }} - {{ selected_user.get_bmi_label }}</p>
                <p><strong>Food Habits:</strong> {{ selected_user.food_habits }}</p>
                <p><strong>Workout Experience:</strong> {{ selected_user.workout_experience }}</p>

                <!-- Form for editing diet and workout plans -->
                <form method="POST">
                    {% csrf_token %}
                    <div class="form-group">
                        <label for="diet_plan">Diet Plan</label>
                        <textarea name="diet_plan" class="form-control" rows="5">{{ selected_user.diet_plan }}</textarea>
                    </div>
                    <div class="form-group">
                        <label for="workout_plan">Workout Plan</label>
                        <textarea name="workout_plan" class="form-control" rows="5">{{ selected_user.workout_plan }}</textarea>
                    </div>
                    <button type="submit" class="btn btn-primary w-100 mt-3">Save Changes</button>
                </form>
            </div>
        {% else %}
            <p class="text-center">Select a user from the dropdown to see and edit their details.</p>
        {% endif %}
    </div>
{% endblock %}
